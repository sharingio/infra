---
# Minimal flux deployment - uncomment in phases
# See: docs/flux-deployment-phases.md
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ./00-namespaces.yaml

  # Phase 0 - Core fixes (before anything else)
  - ./kube-system.yaml             # CoreDNS config fix for OCI

  # Phase 1 - Foundation
  - ./cert-manager.yaml
  # - ./ingress-nginx.yaml       # Replaced by Cilium Gateway API

  # Phase 2 - Storage & Infra
  - ./local-path-storage.yaml
  # - ./longhorn.yaml              # Choose one storage solution
  # - ./reflector.yaml
  # - ./cnpg-system.yaml

  # Phase 3 - Optional Infrastructure (uncomment when needed)
  # - ./kube-fledged.yaml          # Image caching
  # - ./redis-operator.yaml

  # Phase 4 - Advanced (uncomment if needed)
  # - ./kubevirt-operator.yaml
  # - ./kubevirt.yaml
  # - ./capi-operator.yaml
  # - ./rook-ceph.yaml

  # Deprecated/unused
  # - ./cert-manager-webhook-pdns.yaml
